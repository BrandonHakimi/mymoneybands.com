<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mymoneybands | Dashboard</title>
    <link rel="stylesheet" type='text/css' href="/CSS/home.css">
    <script src="https://cdn.anychart.com/releases/8.0.1/js/anychart-core.min.js"></script>  <!--graph code-->
    <script src="https://cdn.anychart.com/releases/8.0.1/js/anychart-pie.min.js"></script>  <!--graph code-->
</head>
<script type = "text/javascript">  //This script should contain all js code for now
                                   //We can place functions in different files later
//HEAD


var FirstName;
var LastName;


var Name;

var MonthlyIncome;
var Budget;
var TotalBills = 0;
var MoneyLeft;
var Choice;
var PastDisplayed = false;
//var Continue;
var Temp;

var MonthlySum;

var ArrayPositionTracker = 0;
//dummy data for past 6 months. Should be changed as new months progress
const PastSixMonths = [[500,200,100,300,1000,275],   //month 1
                       [500,150,50,400,250,350],     //month 2
                       [500,200,15,300,0,400],       //month 3
                       [500,450,200,100,0,0],        //month 4
                       [500,150,300,300,50,50],      //month 5
                       [500,75,100,250,1000,20]];    //month 6
const InputArray = [];
// CategoryArray holds category name, category sum, category percentage
const CategoryArray = [["Bills", 0, 0], 
                       ["Food", 0, 0], 
                       ["Entertainment", 0, 0], 
                       ["Transportation", 0, 0], 
                       ["Education", 0, 0], 
                       ["Other", 0, 0]];

//********************************************************************************************************************************************************

function setCookie(cname,cvalue,exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  let expires = "expires=" + d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function checkCookie() {
    let user = getCookie("username");
    if (user != "") {
    alert("Welcome again, " + user);
    } else {
        user = prompt("Please enter your name:","");
        if (user != "" && user != null) {
            setCookie("username", user, 30);
        }
    }
    Name = user;
}

//********************************************************************************************************************************************************

function Initialize() {
    FirstName = prompt("What is your first name?");
    LastName = prompt("What is your last name?");
    var MonthlyTest = false;
    while (MonthlyTest === false) {
        MonthlyIncome  = prompt("What is your Projected Income for this month?");
        if(isNaN(MonthlyIncome)) {
            window.alert("Invalid Input, please enter a number.");
        } else {
            MonthlyTest = true;
        }
    }
    var BudgetTest = false;
    while (BudgetTest === false) {
        Budget = prompt("What is your budget for this month?");
        if(isNaN(Budget)) {
            window.alert("Invalid Input, please enter a number.");
        } else {
            BudgetTest = true;
        }
    }
    window.alert(`Hello, ${FirstName} ${LastName}. Your projected income for this month is $${MonthlyIncome}. You have set your budget at $${Budget}.`);
}

function InputBills() {
    if (MonthlyIncome === undefined) {
        window.alert("You do not have any data with MyMoneyBands, please select the Initialize button first.");
    } else {
        do {
            var BillName = prompt("Who is this Bill due to? (Company or Label)");
            var BillValue;
            var BillTest = false;
            while (BillTest === false) {
                BillValue = prompt("What is the Payment Amount for this Bill?");
                if(isNaN(BillValue)) {
                    window.alert("Invalid Input, please enter a number.");
                } else {
                    BillTest = true;
                }
            }
            var BillDate = prompt("What is the date that this Bill is due?");
            var RecurringChoice = prompt("Is this Bill a monthly recurring charge?");
            var RecuringCaps = RecurringChoice.toUpperCase();
            var RecurringFlag;
            if (RecuringCaps === "Y" || RecuringCaps === "YE" || RecuringCaps === "YES" || RecuringCaps === "YA" || RecuringCaps === "YEAH" || RecurringChoice === 1) {
                RecurringFlag = true;
                window.alert(`You have input a Bill due to ${BillName} that will charge you $${BillValue} due on ${BillDate}. This Bill is a recurring charge.`);
                InputArray[ArrayPositionTracker] = new Array("BL", BillName, BillValue, BillDate, RecurringFlag, "Bills");
                ArrayPositionTracker++;
            } else {
                RecurringFlag = false;
                window.alert(`You have input a Bill due to ${BillName} that will charge you $${BillValue} due on ${BillDate}. This Bill is not a recurring charge.`);
                InputArray[ArrayPositionTracker] = new Array("BL", BillName, BillValue, BillDate, RecurringFlag, "Bills");
                ArrayPositionTracker++;
            }
            var Continue = prompt("Are there any more bills you wish to input?");
            var ContinueCaps = Continue.toUpperCase();
        } while (ContinueCaps === "Y" || ContinueCaps === "YE" || ContinueCaps === "YES" || ContinueCaps === "YA" || ContinueCaps === "YEAH" || Continue === 1);
    }
}

function InputTransactions() {
    if (MonthlyIncome === undefined) {
        window.alert("You do not have any data with MyMoneyBands, please select the Initialize button first.");
    } else {
        do {
            var TransactionTitle = prompt("What did you spend your money on?");
            var TransactionCost;
            var TransactionTest = false;
            while (TransactionTest === false) {
                TransactionCost = prompt("How much did this transaction cost?");
                if(isNaN(TransactionCost)) {
                    window.alert("Invalid Input, please enter a number.");
                } else {
                    TransactionTest = true;
                }
            }
            var TRCategoryTest = false;
            while (TRCategoryTest === false) {
                var TRCategory = prompt("Which category does this Transaction belong to?\n\tType 1 for Food\n\tType 2 for Entertainment\n\tType 3 for Transportation\n\tType 4 for Education\n\tType 5 for Other");
                var TRCategoryInt = parseFloat(TRCategory);
                switch (TRCategoryInt) {
                case 1:
                    InputArray[ArrayPositionTracker] = new Array("TR", TransactionTitle, TransactionCost, "NULL", "NULL", "Food");
                    TRCategoryTest = true;
                    break;
                case 2: 
                    InputArray[ArrayPositionTracker] = new Array("TR", TransactionTitle, TransactionCost, "NULL", "NULL", "Entertainment");
                    TRCategoryTest = true;
                    break;
                case 3:
                    InputArray[ArrayPositionTracker] = new Array("TR", TransactionTitle, TransactionCost, "NULL", "NULL", "Transportation");
                    TRCategoryTest = true;
                    break;
                case 4:
                    InputArray[ArrayPositionTracker] = new Array("TR", TransactionTitle, TransactionCost, "NULL", "NULL", "Education");
                    TRCategoryTest = true;
                    break;
                case 5:
                    InputArray[ArrayPositionTracker] = new Array("TR", TransactionTitle, TransactionCost, "NULL", "NULL", "Other");
                    TRCategoryTest = true;
                    break;
                default:
                    window.alert("Invalid Input, please enter a valid number.");
                    break;
                }
            }
            window.alert(`You have input a Transaction for ${TransactionTitle} that cost you $${TransactionCost}.`);
            ArrayPositionTracker++;
            var Continue = prompt("Are there any more Transactions you would like to input?");
            var ContinueCaps = Continue.toUpperCase();
        } while (ContinueCaps === "Y" || ContinueCaps === "YE" || ContinueCaps === "YES" || ContinueCaps === "YA" || ContinueCaps === "YEAH" || Continue === 1);
    }
}

//********************************************************************************************************************************************************

function TestInputArray() {
    for (var i = 0; i < InputArray.length; i++) {
        for (var j = 0; j < 6; j++) {
            window.alert(`${i},${j}: ${InputArray[i][j]}`);
        }
    }
}

function TestCategoryArray() {
    for (var i = 0; i < CategoryArray.length; i++) {
        for (var j = 0; j < 3; j++) {
            window.alert(`${i},${j}: ${CategoryArray[i][j]}`);
        }
    }
}

//********************************************************************************************************************************************************

function CalculateMonthlySum() {
    //iterate over InputArray[i][2] for money
    //iterate over InputArray[i][1] for category
    MonthlySum = 0;
    for (var i = 0; i < InputArray.length; i++){
        let temp = parseFloat(InputArray[i][2]);
        if(isNaN(temp) === false){
            MonthlySum += temp;
        }
    }
    window.alert(MonthlySum);
}

function CalculateCategorySums() {
    var CategorySum;
    for (var i = 0; i < CategoryArray.length; i++) {
        CategorySum = 0;
        for (var j = 0; j < InputArray.length; j++) {
            if (CategoryArray[i][0] === InputArray[j][5]) {
                let temp = parseFloat(InputArray[j][2]);
                if (isNaN(temp) === false) {
                    CategorySum += temp;
                }
                CategoryArray[i][1] += (parseFloat(InputArray[i][2]));
            }
        }
        CategoryArray[i][1] = CategorySum;
    }
}

function CalculateCategoryPercentages() {
    for (var i = 0; i < CategoryArray.length; i++) {
        CategoryArray[i][2] = Math.floor((parseFloat(CategoryArray[i][1])/parseFloat(MonthlySum))*100);
    }
}

function Calculate() {
    CalculateMonthlySum();
    CalculateCategorySums();
    CalculateCategoryPercentages();
}

function DisplayGraph() {   
    Calculate();
    Chart();
}

//********************************************************************************************************************************************************

function Chart() {
// set the data
var data = [
    {x: "Bills", value: CategoryArray[0][2]},
    {x: "Food", value: CategoryArray[1][2]},
    {x: "Entertainment", value: CategoryArray[2][2]},
    {x: "Transportation", value: CategoryArray[3][2]},
    {x: "Education", value: CategoryArray[4][2]},
    {x: "Other", value: CategoryArray[5][2]}
];
// create the chart
var chart = anychart.pie();
// set the chart title
chart.title("Your Monthly Spending Organized by Category:");
// add the data
chart.data(data);
// display the chart in the container
chart.container('container');
chart.draw();
}

function PastChart(Stuff)
{
    if (PastDisplayed===false)
    {
        for (var i = 0; i < Stuff.length; i++)
        {
            var data = [
            {x: "Bills", value: Stuff[i][0]},
            {x: "Food", value: Stuff[i][1]},
            {x: "Entertainment", value: Stuff[i][2]},
            {x: "Transportation", value: Stuff[i][3]},
            {x: "Education", value: Stuff[i][4]},
            {x: "Other", value: Stuff[i][5]}
            ];
            // create the chart
            var chart = anychart.pie();
            // set the chart title
            if (i===0)
            chart.title("Your Monthly Spending for last Month.");
            else
            chart.title(`Your Monthly Spending for ${i + 1} Months ago.`);
            // add the data
            chart.data(data);
            // display the chart in the container
            chart.container('Month' + i);
            chart.draw();
        }
        PastDisplayed = true;
    }
}

</script>
<header>
    <div class="menu">
        <img class="logo" src="/IMGs/Screenshot 2022-11-16 at 11.04.00 PM.png" alt="Logo">
        <h3>Hi, Scrum</h3>
        <nav>
        <h2>
            <a href="#"><input type="button" value="Dashboard"></a>
            <br>
            <br>
            <a href="#"><input type="button" value="Recurring"></a>
            <br>
            <br>
            <a href="#"><input type="button" value="Spending"></a>
            <br>
            <br>
            <a href="#"><input type="button" value="Net Worth"></a>
        </h2>
        </nav>
    </div>
</header>
<body> 
    <h1>Good evening, Scrum</h1>
    <nav>
        <br>
        <input type ="button" onclick = "Initialize()" value = "Initialize">
        <input type ="button" onclick = "checkCookie()" value = "Cookie Test Button">
        <input type ="button" onclick = "InputTransactions()" value = "Input Transactions">
        <input type ="button" onclick = "InputBills()" value = "Input Bills">
        <br>
        <br>
        <input type ="button" onclick = "TestInputArray()" value = "TestInputArray (Print all)">
        <input type ="button" onclick = "TestCategoryArray()" value = "TestCategoryArray (Print all)">
        <br>
        <br>
        <br>
        <input type ="button" onclick = "DisplayGraph()" value = "Display this Month's Spending">
        <br>
        <br>
        <input type ="button" onclick = "PastChart(PastSixMonths)" value = "Display Past Spending.">
        <br>
        <div id="container" style="width: 100%; height: 100%"></div>  <!--graph code-->
        <br>
        <div id="Month0" style="width: 100%; height: 100%"></div>
        <br>
        <div id="Month1" style="width: 100%; height: 100%"></div>
        <br>
        <div id="Month2" style="width: 100%; height: 100%"></div>
        <br>
        <div id="Month3" style="width: 100%; height: 100%"></div>
        <br>
        <div id="Month4" style="width: 100%; height: 100%"></div>
        <br>
        <div id="Month5" style="width: 100%; height: 100%"></div>
        <br>
    </nav>  
    <script src="/JS/home.js"></script>
</body>
</html>



<html>  
<head>  
<title>dropdown menu using select tab</title>  
</head>  
<script>  
function favTutorial() {  
var mylist = document.getElementById("myList");  
document.getElementById("favourite").value = mylist.options[mylist.selectedIndex].text;  
}  
</script>  
  
<body>  
<form>  
<b> Select your category using dropdown list </b>  
<select id = "myList" onchange = "favTutorial()" >  
<option> ---Choose Category--- </option>  
<option> Bills </option>  
<option> Food </option>  
<option> Entertainment </option>  
<option> Transportation </option>  
</select>  
<p> Your selected category is:   
<input type = "text" id = "favourite" size = "20"></p>  
</form>  
</body>  
</html>  
