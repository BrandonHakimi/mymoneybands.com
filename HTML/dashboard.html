<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mymoneybands | Dashboard</title>
</head>
<script type = "text/javascript">  //This script should contain all js code for now
                                   //We can place functions in different files later
var MonthlyIncome;
var TotalBills = "";
var Budget;
var MoneyLeft;
var Choice;
var Continue;
var Temp;
var BillName;
var BillValue;
var BillDate;
var Name;

function setCookie(cname,cvalue,exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  let expires = "expires=" + d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function checkCookie() {
  let user = getCookie("username");
  if (user != "") {
    alert("Welcome again " + user);
  } else {
     user = prompt("Please enter your name:","");
     if (user != "" && user != null) {
       setCookie("username", user, 30);
     }
  }
  Name = user;
}

function UserInput() {
    MonthlyIncome  = prompt("What is your Projected Income for this month?");
    Budget = prompt("What is your budget for this month?");
    MoneyLeft = MonthlyIncome - Budget;
    MoneyLeft -= TotalBills;
}

function Bills()
{
var bool = false;
    if(MonthlyIncome === undefined){
        window.alert("No data, please input data.")
    }
    else
    while (1) {
        if (bool === false)
            Continue = prompt("Would you like to input bills for this month? Please type yes or no.")
        else
            Continue = prompt("Are there any more bills you wish to input? Please type yes or no.")
        var ContinueCaps = Continue.toUpperCase();
        if (ContinueCaps === "Y" || ContinueCaps === "YE" || ContinueCaps === "YES" || ContinueCaps === "YA" || ContinueCaps === "YEAH" || Continue === 1) {
            bool = true;
            BillName = prompt("Who is this Bill due to? (Company or Label)");
            BillValue = prompt("What is the Payment Amount for this Bill?");
            TotalBills += BillValue;
            BillDate = prompt("What is the date that this Bill is due?");
            window.alert(`You have input a Bill due to ${BillName} that will charge you ${BillValue} dollars due on ${BillDate}.`);
        }
         else if (ContinueCaps === "N" || ContinueCaps == "NO" || ContinueCaps == "NAW" || ContinueCaps == "NAH" || Continue === 0) {
            if (bool === false)
            TotalBills = 0;
            break;
        }
    } 
    window.alert(`Your projected income is ${MonthlyIncome} dollars and you will be spending ${TotalBills} dollars on bills. With a budget of ${Budget} dollars for the month`);

}

function InputSpending()
{
      if (Budget === undefined)
    window.alert("No data, please input data.")
    else{
    window.alert(`Hello ${Name}, you have a budget of $${Budget} and a total income of ${MonthlyIncome} which leaves you with $${MoneyLeft} to spend on other things.`);
        while(1){
            Continue = prompt("Would you like to input a transaction?")
            var ContinueCaps = Continue.toUpperCase();
                if (ContinueCaps === "Y" || ContinueCaps === "YE" || ContinueCaps === "YES" || ContinueCaps === "YA" || ContinueCaps === "YEAH" || Continue === 1) {
                    var Transaction = prompt("How much was this transaction?");
                    if(isNaN(Transaction))
                         window.alert("Invalid Input, please enter a number.");
                        else
                        MoneyLeft -= Transaction;
                }
            else if (ContinueCaps === "N" || ContinueCaps == "NO" || ContinueCaps == "NAW" || ContinueCaps == "NAH" || Continue === 0) {
                break;
            }
        }
    }
}
</script>

<body> 
    <header>
        <h1>MyMoneyBands</h1>
    </header>
    <nav>
        <h2>
            <input type ="button" onclick = "UserInput()" value = "Input Test Button">
            <br>
            <a href="http://127.0.0.1:5500/HTML/dashboard.html">Dashboard</a>
            <br>
            <input type ="button" onclick = "checkCookie()" value = "Cookie Test Button">
            <br>
            <a href="http://127.0.0.1:5500/HTML/recurring.html">Recurring</a>
            <br>
            <input type ="button" onclick = "InputSpending()" value = "Spending Test Button">
            <br>
            <input type ="button" onclick = "Bills()" value = "Input Bills Button">
            <br>
            <a href="http://127.0.0.1:5500/HTML/spending.html">Spending</a>
            <br> 
            <a href="http://127.0.0.1:5500/HTML/networth.html">Networth</a>
        </h2>
    </nav>  
</body>
</html>
